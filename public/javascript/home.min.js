const socket=io();socket.on("alert",message=>{alert(message.message)});let intervalID;async function updateTimeLeft(){const now=new Date;let allExpired=true;document.querySelectorAll(".video-card").forEach(async videoCard=>{let timeElement=videoCard.querySelector(".video-time");let statusElement=videoCard.querySelector(".video-status");if(!timeElement){timeElement=document.createElement("span");timeElement.classList.add("video-time");videoCard.appendChild(timeElement)}if(!statusElement){statusElement=document.createElement("span");statusElement.classList.add("video-status");statusElement.style.display="none";videoCard.appendChild(statusElement)}const videoTime=new Date(timeElement.dataset.time);const timeLeft=videoTime-now;if(timeLeft>0){allExpired=false;const days=Math.floor(timeLeft/(1e3*60*60*24));const hours=Math.floor(timeLeft%(1e3*60*60*24)/(1e3*60*60));const minutes=Math.floor(timeLeft%(1e3*60*60)/(1e3*60));timeElement.textContent=days>0?`Time Left: ${days}d ${hours}h ${minutes}m`:`Time Left: ${hours}h ${minutes}m`;timeElement.style.display="block";statusElement.style.display="none"}else{timeElement.style.display="none";const videoId=videoCard.dataset.id;if(videoId){const response=await fetch(`/get-status/${videoId}`);const data=await response.json();if(data.LiveStatus==="Processing"){await fetch(`/update-status/${videoId}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({LiveStatus:"Live"})})}}}});if(allExpired&&intervalID){clearInterval(intervalID);console.log("All countdowns are finished, interval stopped.")}}intervalID=setInterval(updateTimeLeft,1e3);updateTimeLeft();document.addEventListener("DOMContentLoaded",()=>{const banner=document.querySelector(".banner");const closeButton=document.querySelector(".close-button");const body=document.body;const container=document.querySelector(".container");const userId="<%= user._id %>";const bannerKey=`bannerShown_${userId}`;function showBanner(){banner.style.display="block";container.classList.add("blur");body.classList.add("no-scroll")}closeButton.addEventListener("click",()=>{banner.style.display="none";container.classList.remove("blur");body.classList.remove("no-scroll");sessionStorage.setItem(bannerKey,"true")});if(!sessionStorage.getItem(bannerKey)){showBanner()}});