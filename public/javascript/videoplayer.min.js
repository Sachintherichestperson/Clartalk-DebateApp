const socket=io();const followbtn=document.querySelector(".follow-btn");const commentbtn=document.querySelector(".comments");const allcomments=document.querySelector(".allcomments");const msgbox=document.querySelector(".msg-box");const postBtn=document.getElementById("post-btn");const commentInput=document.getElementById("comment-input");const commentSection=document.getElementById("comment-section");const commentCount=document.getElementById("comment-count");const video=document.getElementById("videoPlayer");let startTime=0;let endTime=0;let watchTime=0;followbtn.addEventListener("click",()=>{socket.emit("Follow",{creatorId:creatorId,UserId:UserId});const span=followbtn.querySelector("span")});socket.on("FollowStatusUpdated",data=>{const followbtn=document.querySelector(`.follow-btn[data-creator-id='${data.creatorId}']`);const followersCountElement=document.querySelector(".followers-count");if(followbtn){const span=followbtn.querySelector("span");if(data.isFollowing){span.classList.remove("follow");span.classList.add("unfollow");span.textContent="Unfollow"}else{span.classList.remove("unfollow");span.classList.add("follow");span.textContent="Follow"}}if(followersCountElement){console.log("followers Count",data.followersCount);followersCountElement.textContent=`${data.followersCount} Followers`}});video.addEventListener("play",()=>{startTime=Date.now()});function sendWatchTime(){if(startTime){let endTime=Date.now();watchTime+=(endTime-startTime)/1e3;startTime=0;fetch("/watch-time",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({watchTime:watchTime,vedioId:vedioId,videoType:currentRoute})})}}video.addEventListener("pause",sendWatchTime);video.addEventListener("ended",sendWatchTime);window.addEventListener("beforeunload",()=>{sendWatchTime()});postBtn.addEventListener("click",()=>{const commentText=commentInput.value.trim();if(commentText){const commentData={text:commentText,userId:userid,videoType:currentRoute,vedioId:vedioId};console.log(commentData);socket.emit("VideonewComment",commentData);commentInput.value=""}});socket.on("addComment",data=>{const commentElement=document.createElement("div");commentElement.classList.add("single-comment");commentElement.innerHTML=`
        <img src="${data.image}" alt="" class="comment-image">
        <p><strong>${data.username}:</strong> ${data.text}</p>
    `;commentSection.prepend(commentElement);commentCount.textContent=parseInt(commentCount.textContent)+1});commentbtn.addEventListener("click",event=>{event.stopPropagation();allcomments.classList.add("active");msgbox.classList.add("active");commentbtn.classList.add("active")});document.addEventListener("click",event=>{if(!allcomments.contains(event.target)&&!msgbox.contains(event.target)&&!commentbtn.contains(event.target)){allcomments.classList.remove("active");msgbox.classList.remove("active");commentbtn.classList.remove("active")}});