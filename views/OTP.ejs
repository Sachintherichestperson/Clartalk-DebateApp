<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OTP</title>
    <link rel="stylesheet" href="./stylesheets/Signup.css">
</head>
<body>
    <form id="otpForm">
        <label for="otp">Enter OTP:</label>
        <div class="otp-box">
            <input type="text" maxlength="1" class="otp-input" required>
            <input type="text" maxlength="1" class="otp-input" required>
            <input type="text" maxlength="1" class="otp-input" required>
            <input type="text" maxlength="1" class="otp-input" required>
            <input type="text" maxlength="1" class="otp-input" required>
            <input type="text" maxlength="1" class="otp-input" required>
        </div>
        <button type="submit">Verify</button>
    </form>
    
    <script>

const otpInputs = document.querySelectorAll(".otp-input");

otpInputs.forEach((input, index) => {
    input.addEventListener("input", (e) => {
        if (e.target.value.length === 1) {
            if (index < otpInputs.length - 1) {
                otpInputs[index + 1].focus(); // Move to next input
            }
        }
    });

    input.addEventListener("keydown", (e) => {
        if (e.key === "Backspace" && input.value === "") {
            if (index > 0) {
                otpInputs[index - 1].focus(); // Move to previous input on backspace
            }
        }
    });
});



        document.getElementById("otpForm").addEventListener("submit", async function (event) {
            event.preventDefault();
    
            const otpInputs = document.querySelectorAll(".otp-input");
            const otp = Array.from(otpInputs).map(input => input.value).join(""); // Combine input values
            const email = sessionStorage.getItem("email"); // Get email from session
    
            const response = await fetch("/verify-otp", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ email, otp }),
});

const data = await response.json();

if (data.success) {
    window.location.href = data.redirectUrl;  // Redirect to "/"
} else {
    alert(data.error);
}

        });
    </script>    
</body>
</html>